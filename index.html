<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NUCS Diary â€“ Write</title>

<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">

<style>
body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
#editor { height: 300px; }
input, button { margin-top: 10px; width: 100%; padding: 8px; }
</style>
</head>
<body>

<h1>Write a post</h1>

<input id="title" placeholder="Post title">

<div id="editor"></div>

<input id="ogImage" placeholder="Preview image URL (optional)">

<button onclick="publish()">Publish</button>

<script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
<script>
const quill = new Quill('#editor', {
  theme: 'snow',
  modules: {
    toolbar: [
      ['bold','italic','underline'],
      [{ header: [1,2,false] }],
      ['link','image'],
      [{ list: 'ordered' }, { list: 'bullet' }],
      ['clean']
    ]
  }
});

async function publish() {
  const content = quill.root.innerHTML;
  if (content === '<p><br></p>') return alert('Write something');

  const res = await fetch('/publish', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      title: document.getElementById('title').value,
      content,
      ogImage: document.getElementById('ogImage').value
    })
  });

  const data = await res.json();
  location.href = data.url;
}
</script>
</body>
</html>
